<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>API – ncr</title>
    <link rel="stylesheet" href="../css/styles.css">
</head>

<body>
    <header>…</header>

    <main class="container docs-content">
        <h1>API Reference (ncr 0.0.1)</h1>

        <h2>Core</h2>
        <table>
            <tr>
                <th>Function / Class</th>
                <th>Purpose</th>
            </tr>
            <tr>
                <td><code>ncr.NCRNet(input_dim, hidden_dims, output_dim=1)</code></td>
                <td>Simple MLP used in the paper (you can plug in any nn.Module).</td>
            </tr>
            <tr>
                <td><code>ncr.train_ncr(model, env_loaders, criterion, *, lambda_reg, penalty, epochs, lr)</code></td>
                <td>Training loop that adds <code>lambda_reg × penalty</code> to mean risk.</td>
            </tr>
            <tr>
                <td><code>ncr.risk_gap(r1,r2)</code></td>
                <td>|r₁ − r₂|  (default penalty)</td>
            </tr>
            <tr>
                <td><code>ncr.risk_variance(r1,r2)</code></td>
                <td>0.5 (r₁ − r₂)²  (REx)</td>
            </tr>
            <tr>
                <td><code>ncr.accuracy(model, loader)</code></td>
                <td>Binary accuracy helper.</td>
            </tr>
        </table>

        <h2>Utilities</h2>
        <table>
            <tr>
                <th>Function</th>
                <th>Description</th>
            </tr>
            <tr>
                <td><code>ncr.utils.tune_lambda(...)</code></td>
                <td>Grid‑search λ on a validation loader; returns best model &amp; λ.</td>
            </tr>
        </table>

        <h2>Experimental helpers</h2>
        <ul>
            <li><code>experiments/colored_mnist.py</code> – synthetic dataset builders.</li>
            <li><code>experiments/run_colored_mnist.py</code> – reproduces Table 1.</li>
        </ul>

        See doc‑strings in the source files for full parameter lists.
    </main>
    <footer>…</footer>
</body>

</html>