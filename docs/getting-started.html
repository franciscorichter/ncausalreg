<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Quick‑Start – ncr</title>
    <link rel="stylesheet" href="../css/styles.css">
</head>

<body>
    <header>…</header>

    <main class="container docs-content">
        <h1>Getting Started</h1>

        <h2>1. Minimal example</h2>
        <pre><code class="python">import torch
from torch.utils.data import DataLoader, TensorDataset
from ncr import NCRNet, train_ncr, risk_gap, accuracy

# two synthetic environments --------------------------------------------------
x0, y0 = torch.randn(256, 20), torch.randint(0, 2, (256,1)).float()
x1, y1 = torch.randn(256, 20), torch.randint(0, 2, (256,1)).float()
loaders = [DataLoader(TensorDataset(x0, y0), batch_size=32, shuffle=True),
           DataLoader(TensorDataset(x1, y1), batch_size=32, shuffle=True)]

# model + training ------------------------------------------------------------
model = NCRNet(input_dim=20, hidden_dims=(64,64))
train_ncr(model, loaders,
          criterion=torch.nn.BCEWithLogitsLoss(),
          lambda_reg=1.0,      # λ = γ in the paper
          penalty=risk_gap,
          epochs=20)

print("env‑0 acc:", accuracy(model, loaders[0]))
print("env‑1 acc:", accuracy(model, loaders[1]))
</code></pre>

        <h2>2. Automatic λ tuning</h2>
        <pre><code class="python">from ncr.utils import tune_lambda
best_model, lam, hist = tune_lambda(
        model_ctor=lambda: NCRNet(20,(64,64),1),
        env_loaders=loaders,
        val_loader =loaders[1],
        criterion  =torch.nn.BCEWithLogitsLoss(),
        lambdas    =[0.1, 1, 10])
print("λ chosen =", lam)</code></pre>

        <h2>3. Next steps</h2>
        <ul>
            <li>Run the full <code>experiments/run_colored_mnist.py</code> benchmark.</li>
            <li>Read <a href="theory.html">theory & objective</a> for math details.</li>
            <li>See <a href="api.html">API reference</a> for every public function.</li>
        </ul>
    </main>
    <footer>…</footer>
</body>

</html>

