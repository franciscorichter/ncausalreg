<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Theory – ncr</title>
    <link rel="stylesheet" href="../css/styles.css">
</head>

<body>
    <header>…</header>

    <main class="container docs-content">
        <h1>Theoretical Background</h1>

        <p>Suppose two training environments <em>e = 1,2</em> yield empirical risks
            \(R_e(θ)\).
            Neural Causal Regularization minimises</p>

        \[
        \mathcal L(θ)
        = \tfrac12\bigl[R_1 + R_2\bigr]
        \;+\; γ \,\bigl\lvert R_1 - R_2\bigr\rvert
        \]

        <ul>
            <li><strong>First term</strong> = ordinary empirical risk.</li>
            <li><strong>Second term</strong> = ℓ<sub>1</sub> gap that punishes
                environment‑specific fitting.</li>
            <li>Set γ → 0 ➜ ERM.
                Set γ large ➜ risks forced to equalise ➜ causal solution.</li>
        </ul>

        <h2>Why ℓ<sub>1</sub> not variance?</h2>
        <p>The absolute gap provides a **tighter convex upper‑bound** on the
            worst‑environment risk than the quadratic variance used by REx, leading
            to faster optimisation and fewer hyper‑parameters.</p>

        <h2>λ re‑parameterisation</h2>
        <p>Define \(\lambda = \tfrac{γ}{1+γ} ∈ [0,1)\).
            Then the objective is a convex combination of mean risk and gap:
            \((1-λ)\bar R + λ|R_1-R_2|\).</p>

        <h2>Generalisation guarantee (brief)</h2>
        <ul>
            <li>If the true data‑generating process factorises as
                \(Y = f(X_S)+ε\) with <em>X<sub>S</sub></em> causally invariant, and
                if the two environments vary only in non‑causal features, then</li>
            <li>\(\min_θ\mathcal L(θ)\) recovers a predictor that depends
                only on <em>X<sub>S</sub></em>, hence generalises to unseen shifts.</li>
        </ul>

        For full proofs see Section 4 of the paper (Richter et al., 2025).
    </main>
    <footer>…</footer>
</body>

</html>